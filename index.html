<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Dashboard Indicadores COP Rede - Equipe Nelson Soares</title>
<style>
*{margin:0;padding:0;box-sizing:border-box}
body{font-family:'Segoe UI',Tahoma,sans-serif;background:#0f1117;color:#e0e0e0;min-height:100vh}
.hdr{background:linear-gradient(135deg,#1a1a2e,#16213e);padding:18px 30px;display:flex;align-items:center;justify-content:space-between;border-bottom:3px solid #e50914}
.hdr h1{font-size:1.3em;color:#fff}
.hdr .inf{font-size:.8em;opacity:.7;color:#aaa}
.ctn{max-width:1500px;margin:0 auto;padding:15px}
.period-info{background:#16213e;padding:12px 20px;border-radius:8px;margin-bottom:15px;display:flex;justify-content:space-between;align-items:center;border:1px solid #2a2a4a}
.period-info span{font-size:.85em;color:#aaa}
.period-info strong{color:#e50914}
.tabs{display:flex;gap:5px;margin:12px 0;flex-wrap:wrap}
.tab{padding:8px 18px;background:#16213e;border:1px solid #2a2a4a;border-radius:6px 6px 0 0;cursor:pointer;font-size:.82em;color:#aaa;transition:all .2s}
.tab.act{background:#e50914;color:#fff;border-color:#e50914}
.tab:hover{border-color:#e50914}
.panel{display:none}
.panel.act{display:block}
.kg{display:grid;grid-template-columns:repeat(auto-fill,minmax(220px,1fr));gap:12px;margin:15px 0}
.kc{background:linear-gradient(145deg,#16213e,#1a1a2e);border-radius:10px;padding:15px;border:1px solid #2a2a4a;transition:transform .2s;position:relative;overflow:hidden}
.kc:hover{transform:translateY(-2px);border-color:#e50914}
.kc .lb{font-size:.7em;color:#999;text-transform:uppercase;letter-spacing:.5px;margin-bottom:4px}
.kc .vl{font-size:1.8em;font-weight:700;margin:4px 0}
.kc .mt{font-size:.7em;color:#666;margin-top:2px}
.kc .bar{height:3px;background:#2a2a4a;border-radius:2px;margin-top:8px;overflow:hidden}
.kc .bar-fill{height:100%;border-radius:2px;transition:width .5s}
.gr{color:#00c853}.yl{color:#ffc107}.rd{color:#ff5252}
.bg-gr{background:#00c853}.bg-yl{background:#ffc107}.bg-rd{background:#ff5252}
.sec{margin:20px 0}
.sec h2{font-size:1.15em;margin-bottom:10px;padding-bottom:6px;border-bottom:2px solid #e50914;display:inline-block;color:#fff}
table{width:100%;border-collapse:collapse;font-size:.78em;margin-top:8px}
th{background:#16213e;color:#aaa;padding:8px 10px;text-align:left;font-weight:600;text-transform:uppercase;font-size:.72em;letter-spacing:.5px;border-bottom:2px solid #e50914;position:sticky;top:0}
td{padding:7px 10px;border-bottom:1px solid #1e2a4a}
tr:hover td{background:rgba(229,9,20,.05)}
.badge{display:inline-block;padding:2px 8px;border-radius:10px;font-size:.72em;font-weight:600}
.badge-gr{background:rgba(0,200,83,.15);color:#00c853}
.badge-yl{background:rgba(255,193,7,.15);color:#ffc107}
.badge-rd{background:rgba(255,82,82,.15);color:#ff5252}
.legend{display:flex;gap:15px;margin:10px 0;font-size:.75em;flex-wrap:wrap}
.legend span{display:flex;align-items:center;gap:4px}
.legend .dot{width:10px;height:10px;border-radius:50%;display:inline-block}
.note{background:#1a1a2e;border-left:3px solid #e50914;padding:10px 15px;margin:10px 0;font-size:.78em;color:#999;border-radius:0 6px 6px 0}
.tbl-wrap{overflow-x:auto;border-radius:8px;border:1px solid #2a2a4a}
@media(max-width:768px){.kg{grid-template-columns:1fr 1fr}.hdr{flex-direction:column;gap:5px}}
</style>
</head>
<body>
<div class="hdr">
<div><h1>‚ö° Dashboard Indicadores COP Rede</h1><div class="inf">Equipe Nelson Soares | COP REDE RJ | Leste - Rio e ES</div></div>
<div style="text-align:right"><div class="inf">üìÖ Per√≠odo: Fevereiro/2026</div><div class="inf">Atualizado: 12/02/2026</div></div>
</div>
<div class="ctn">
<div class="period-info">
<span>üìä <strong>M√™s de Refer√™ncia:</strong> Fevereiro/2026 (parcial at√© 12/02)</span>
<span>üîÑ Pr√≥xima atualiza√ß√£o semanal: 19/02/2026</span>
</div>
<div class="tabs">
<div class="tab act" onclick="showPanel('cons')">Consolidado</div>
<div class="tab" onclick="showPanel('emp')">Empresarial (13)</div>
<div class="tab" onclick="showPanel('res')">Residencial (8)</div>
<div class="tab" onclick="showPanel('metas')">Metas & Gloss√°rio</div>
</div>

<div id="cons" class="panel act"></div>
<div id="emp" class="panel"></div>
<div id="res" class="panel"></div>
<div id="metas" class="panel"></div>
</div>

<script>
const METAS = {
'DPA - Ocupa√ß√£o': {meta:90,dir:'up'},
'Chat TOA': {meta:75,dir:'up'},
'ETIT por Evento RAL': {meta:90,dir:'up'},
'ETIT por Evento REC': {meta:90,dir:'up'},
'ETIT Outage Sem Sinal (GPON)': {meta:90,dir:'up'},
'Log Outage Reprog. GPON': {meta:10,dir:'down'},
'ETIT Outage Res. Sem Sinal': {meta:90,dir:'up'},
'ETIT Outage Res. Degrada√ß√£o': {meta:90,dir:'up'},
'Tempo Valid. Formul√°rio': {meta:80,dir:'down'},
'Tarefas Canceladas': {meta:15,dir:'up'},
'Fechamento TOA x SIR': {meta:80,dir:'up'}
};

const EMPRESARIAL = [
{login:'N6088107',nome:'LEANDRO GON√áALVES DE CARVALHO'},
{login:'N5619600',nome:'BRUNO COSTA BUCARD'},
{login:'N0189105',nome:'IGOR MARCELINO DE MARINS'},
{login:'N5737414',nome:'SANDRO DA SILVA CARVALHO'},
{login:'N5713690',nome:'GABRIELA TAVARES DA SILVA'},
{login:'N5802257',nome:'MAGNO FERRAREZ DE MORAIS'},
{login:'F201714',nome:'FERNANDA MESQUITA DE FREITAS'},
{login:'N6173055',nome:'JEFFERSON LUIS GON√áALVES COITINHO'},
{login:'N0125317',nome:'ROBERTO SILVA DO NASCIMENTO'},
{login:'F218860',nome:'ALDENES MARQUES IDALINO DA SILVA'},
{login:'N5819183',nome:'RODRIGO PIRES BERNARDINO'},
{login:'N5926003',nome:'SUELLEN HERNANDEZ DA SILVA'},
{login:'N5932064',nome:'MONICA DA SILVA RODRIGUES'}
];

const RESIDENCIAL = [
{login:'N0238475',nome:'MARLEY MARQUES RIBEIRO'},
{login:'N5923221',nome:'KELLY PINHEIRO LIRA'},
{login:'N5772086',nome:'THIAGO PEREIRA DA SILVA'},
{login:'N0239871',nome:'LEONARDO FERREIRA LIMA DE ALMEIDA'},
{login:'N5577565',nome:'MARISTELLA MARCIA DOS SANTOS'},
{login:'N5972428',nome:'CRISTIANE HERMOGENES DA SILVA'},
{login:'N4014011',nome:'ALAN MARINHO DIAS'},
{login:'F106664',nome:'RAISSA LIMA DE OLIVEIRA'}
];

const INDICADORES = [
'DPA - Ocupa√ß√£o','Chat TOA','ETIT por Evento RAL','ETIT por Evento REC',
'ETIT Outage Sem Sinal (GPON)','Log Outage Reprog. GPON','ETIT Outage Res. Sem Sinal',
'ETIT Outage Res. Degrada√ß√£o','Tempo Valid. Formul√°rio','Tarefas Canceladas','Fechamento TOA x SIR'
];

function getStatus(valor, indicador) {
  const m = METAS[indicador];
  if (!m || valor === null || valor === undefined || valor === '-') return {cls:'yl',badge:'badge-yl',text:'N/D'};
  const v = parseFloat(valor);
  if (isNaN(v)) return {cls:'yl',badge:'badge-yl',text:'N/D'};
  if (m.dir === 'up') {
    if (v >= m.meta) return {cls:'gr',badge:'badge-gr',text:'‚úî Atingido'};
    if (v >= m.meta * 0.9) return {cls:'yl',badge:'badge-yl',text:'‚ö† Aten√ß√£o'};
    return {cls:'rd',badge:'badge-rd',text:'‚úñ Abaixo'};
  } else {
    if (v <= m.meta) return {cls:'gr',badge:'badge-gr',text:'‚úî Atingido'};
    if (v <= m.meta * 1.1) return {cls:'yl',badge:'badge-yl',text:'‚ö† Aten√ß√£o'};
    return {cls:'rd',badge:'badge-rd',text:'‚úñ Abaixo'};
  }
}

function pct(v, indicador) {
  const m = METAS[indicador];
  if (!m || v === null || v === '-') return 0;
  const val = parseFloat(v);
  if (isNaN(val)) return 0;
  if (m.dir === 'up') return Math.min(100, (val / m.meta) * 100);
  return Math.min(100, (m.meta / Math.max(val, 0.1)) * 100);
}

function buildKPICards(data, containerId) {
  let html = '<div class="kg">';
  for (const ind of INDICADORES) {
    const val = data[ind];
    const st = getStatus(val, ind);
    const m = METAS[ind];
    const displayVal = (val !== null && val !== undefined && val !== '-') ? val + '%' : 'Aguardando dados';
    const pctVal = pct(val, ind);
    const dirLabel = m.dir === 'up' ? '‚Üë Meta: ‚â•' + m.meta + '%' : '‚Üì Meta: ‚â§' + m.meta + '%';
    html += '<div class="kc"><div class="lb">' + ind + '</div>';
    html += '<div class="vl ' + st.cls + '">' + displayVal + '</div>';
    html += '<div class="mt">' + dirLabel + ' | <span class="' + st.badge + ' badge">' + st.text + '</span></div>';
    html += '<div class="bar"><div class="bar-fill bg-' + st.cls + '" style="width:' + pctVal + '%"></div></div>';
    html += '</div>';
  }
  html += '</div>';
  return html;
}

function buildAnalystTable(analysts, sectorData) {
  let html = '<div class="tbl-wrap"><table><thead><tr><th>Login</th><th>Analista</th>';
  for (const ind of INDICADORES) {
    html += '<th>' + ind + '</th>';
  }
  html += '<th>Status</th></tr></thead><tbody>';
  for (const a of analysts) {
    const d = sectorData[a.login] || {};
    let atingidos = 0;
    let total = 0;
    html += '<tr><td style="font-family:monospace;font-size:.75em">' + a.login + '</td><td style="white-space:nowrap">' + a.nome + '</td>';
    for (const ind of INDICADORES) {
      const v = d[ind];
      const st = getStatus(v, ind);
      const display = (v !== null && v !== undefined && v !== '-') ? v + '%' : '-';
      if (v !== null && v !== undefined && v !== '-') {
        total++;
        if (st.cls === 'gr') atingidos++;
      }
      html += '<td class="' + st.cls + '">' + display + '</td>';
    }
    const statusPct = total > 0 ? Math.round((atingidos/total)*100) : 0;
    html += '<td><span class="badge ' + (statusPct >= 80 ? 'badge-gr' : statusPct >= 60 ? 'badge-yl' : 'badge-rd') + '">' + atingidos + '/' + total + '</span></td>';
    html += '</tr>';
  }
  html += '</tbody></table></div>';
  return html;
}

// ============================================
// DADOS FEVEREIRO 2026 - CONSOLIDADO GRUPO
// (Fonte: Power BI - Grupo Rio e ES / Leste)
// Atualizar semanalmente com dados reais
// ============================================

const dadosConsolidadoEmp = {
'DPA - Ocupa√ß√£o': 88.35,
'Chat TOA': 85.7,
'ETIT por Evento RAL': 88.6,
'ETIT por Evento REC': 88.6,
'ETIT Outage Sem Sinal (GPON)': 85.7,
'Log Outage Reprog. GPON': null,
'ETIT Outage Res. Sem Sinal': null,
'ETIT Outage Res. Degrada√ß√£o': null,
'Tempo Valid. Formul√°rio': null,
'Tarefas Canceladas': null,
'Fechamento TOA x SIR': null
};

const dadosConsolidadoRes = {
'DPA - Ocupa√ß√£o': 84.90,
'Chat TOA': 85.7,
'ETIT por Evento RAL': null,
'ETIT por Evento REC': null,
'ETIT Outage Sem Sinal (GPON)': 85.7,
'Log Outage Reprog. GPON': null,
'ETIT Outage Res. Sem Sinal': null,
'ETIT Outage Res. Degrada√ß√£o': null,
'Tempo Valid. Formul√°rio': null,
'Tarefas Canceladas': null,
'Fechamento TOA x SIR': null
};

// Dados consolidados gerais (m√©dia ponderada)
const dadosConsolidado = {};
for (const ind of INDICADORES) {
  const e = dadosConsolidadoEmp[ind];
  const r = dadosConsolidadoRes[ind];
  if (e !== null && r !== null) dadosConsolidado[ind] = Math.round(((e * 13 + r * 8) / 21) * 100) / 100;
  else if (e !== null) dadosConsolidado[ind] = e;
  else if (r !== null) dadosConsolidado[ind] = r;
  else dadosConsolidado[ind] = null;
}

// Dados por analista - PREENCHER COM DADOS REAIS DO ANAL√çTICO
const dadosEmpAnalistas = {};
for (const a of EMPRESARIAL) {
  dadosEmpAnalistas[a.login] = {};
  for (const ind of INDICADORES) dadosEmpAnalistas[a.login][ind] = null;
}

const dadosResAnalistas = {};
for (const a of RESIDENCIAL) {
  dadosResAnalistas[a.login] = {};
  for (const ind of INDICADORES) dadosResAnalistas[a.login][ind] = null;
}

// BUILD PANELS
function buildConsolidado() {
  let h = '<div class="sec"><h2>üìä Vis√£o Consolidada - Fevereiro/2026</h2>';
  h += '<div class="note">‚ÑπÔ∏è Dados do grupo <strong>Rio e ES / Leste</strong> extra√≠dos do Power BI. Valores \"null\" aguardam extra√ß√£o dos anal√≠ticos ou atualiza√ß√£o semanal.</div>';
  h += buildKPICards(dadosConsolidado, 'cons');
  h += '</div>';
  
  h += '<div class="sec"><h2>Empresarial (Grupo Rio e ES)</h2>';
  h += buildKPICards(dadosConsolidadoEmp, 'cons-emp');
  h += '</div>';
  
  h += '<div class="sec"><h2>Residencial (Grupo Rio e ES)</h2>';
  h += buildKPICards(dadosConsolidadoRes, 'cons-res');
  h += '</div>';
  
  h += '<div class="sec"><h2>üìã Resumo Comparativo</h2>';
  h += '<div class="tbl-wrap"><table><thead><tr><th>Indicador</th><th>Meta</th><th>Dire√ß√£o</th><th>Empresarial</th><th>Residencial</th><th>Consolidado</th></tr></thead><tbody>';
  for (const ind of INDICADORES) {
    const m = METAS[ind];
    const eVal = dadosConsolidadoEmp[ind];
    const rVal = dadosConsolidadoRes[ind];
    const cVal = dadosConsolidado[ind];
    const eSt = getStatus(eVal, ind);
    const rSt = getStatus(rVal, ind);
    const cSt = getStatus(cVal, ind);
    h += '<tr><td><strong>' + ind + '</strong></td>';
    h += '<td>' + m.meta + '%</td>';
    h += '<td>' + (m.dir==='up'?'‚Üë Bom p/ +':'‚Üì Bom p/ -') + '</td>';
    h += '<td class="' + eSt.cls + '">' + (eVal !== null ? eVal + '%' : '-') + '</td>';
    h += '<td class="' + rSt.cls + '">' + (rVal !== null ? rVal + '%' : '-') + '</td>';
    h += '<td class="' + cSt.cls + '"><strong>' + (cVal !== null ? cVal + '%' : '-') + '</strong></td>';
    h += '</tr>';
  }
  h += '</tbody></table></div></div>';
  return h;
}

function buildSector(sectorName, analysts, sectorConsolidado, analystData) {
  let h = '<div class="sec"><h2>üìä ' + sectorName + ' - Consolidado Fevereiro/2026</h2>';
  h += buildKPICards(sectorConsolidado, sectorName);
  h += '</div>';
  h += '<div class="sec"><h2>üë• ' + sectorName + ' - Por Analista</h2>';
  h += '<div class="note">‚ÑπÔ∏è Dados individuais ser√£o preenchidos ap√≥s extra√ß√£o do anal√≠tico (Anal√≠tico Indicadores TOA - 202602.xlsx). Campos com \"-\" aguardam dados.</div>';
  h += buildAnalystTable(analysts, analystData);
  h += '</div>';
  return h;
}

function buildMetas() {
  let h = '<div class="sec"><h2>üéØ Metas e Gloss√°rio dos Indicadores</h2>';
  h += '<div class="tbl-wrap"><table><thead><tr><th>#</th><th>Indicador</th><th>Meta</th><th>Dire√ß√£o</th><th>Descri√ß√£o</th><th>Per√≠odo</th></tr></thead><tbody>';
  
  const descs = {
    'DPA - Ocupa√ß√£o': '% de ocupa√ß√£o produtiva do colaborador',
    'Chat TOA': '% de intera√ß√£o dentro de 10 min',
    'ETIT por Evento RAL': '% tarefas direcionadas para o t√©cnico em at√© 30min (RAL)',
    'ETIT por Evento REC': '% tarefas direcionadas para o t√©cnico em at√© 30min (REC)',
    'ETIT Outage Sem Sinal (GPON)': 'Volume dentro do prazo (DP) / Volume total - GPON',
    'Log Outage Reprog. GPON': '% outages reprogramados sintoma sem sinal GPON',
    'ETIT Outage Res. Sem Sinal': 'Data/Hora do primeiro acionamento para o TOA - Sem Sinal',
    'ETIT Outage Res. Degrada√ß√£o': 'Data/Hora do primeiro acionamento para o TOA - Degrada√ß√£o',
    'Tempo Valid. Formul√°rio': 'Tempo de valida√ß√£o do formul√°rio ap√≥s conclus√£o',
    'Tarefas Canceladas': '% de tarefas canceladas sobre o total',
    'Fechamento TOA x SIR': 'Assertividade do fechamento TOA versus SIR'
  };
  
  const periodos = {
    'DPA - Ocupa√ß√£o': 'Madrugada',
    'Chat TOA': 'Madrugada',
    'ETIT por Evento RAL': 'Madrugada',
    'ETIT por Evento REC': 'Madrugada',
    'ETIT Outage Sem Sinal (GPON)': 'Todos',
    'Log Outage Reprog. GPON': 'Todos',
    'ETIT Outage Res. Sem Sinal': 'Todos',
    'ETIT Outage Res. Degrada√ß√£o': 'Todos',
    'Tempo Valid. Formul√°rio': 'Todos',
    'Tarefas Canceladas': 'Todos',
    'Fechamento TOA x SIR': 'Todos'
  };
  
  let i = 1;
  for (const ind of INDICADORES) {
    const m = METAS[ind];
    h += '<tr><td>' + i + '</td><td><strong>' + ind + '</strong></td>';
    h += '<td class="' + (m.dir==='up'?'gr':'rd') + '">' + m.meta + '%</td>';
    h += '<td>' + (m.dir==='up'?'‚Üë Quanto maior, melhor':'‚Üì Quanto menor, melhor') + '</td>';
    h += '<td>' + (descs[ind]||'') + '</td>';
    h += '<td>' + (periodos[ind]||'Todos') + '</td></tr>';
    i++;
  }
  h += '</tbody></table></div></div>';
  
  h += '<div class="sec"><h2>üìÖ Calend√°rio de Atualiza√ß√µes</h2>';
  h += '<div class="note"><strong>Fluxo semanal:</strong> Atualizar dados toda segunda-feira com dados da semana anterior.<br>';
  h += '<strong>Fechamento mensal:</strong> Ao final do m√™s, consolidar dados finais e iniciar novo m√™s na semana seguinte.<br>';
  h += '<strong>Indicadores com per√≠odo Madrugada:</strong> DPA, Chat TOA, ETIT RAL, ETIT REC - filtrar per√≠odo como "Madrugada" no Power BI.</div>';
  h += '</div>';
  
  h += '<div class="sec"><h2>üë• Equipe Completa</h2>';
  h += '<div class="tbl-wrap"><table><thead><tr><th>Setor</th><th>Login</th><th>Nome Completo</th></tr></thead><tbody>';
  for (const a of EMPRESARIAL) {
    h += '<tr><td><span class="badge badge-gr">EMP</span></td><td style="font-family:monospace">' + a.login + '</td><td>' + a.nome + '</td></tr>';
  }
  for (const a of RESIDENCIAL) {
    h += '<tr><td><span class="badge badge-rd">RES</span></td><td style="font-family:monospace">' + a.login + '</td><td>' + a.nome + '</td></tr>';
  }
  h += '</tbody></table></div></div>';
  
  return h;
}

// RENDER
document.getElementById('cons').innerHTML = buildConsolidado();
document.getElementById('emp').innerHTML = buildSector('Empresarial', EMPRESARIAL, dadosConsolidadoEmp, dadosEmpAnalistas);
document.getElementById('res').innerHTML = buildSector('Residencial', RESIDENCIAL, dadosConsolidadoRes, dadosResAnalistas);
document.getElementById('metas').innerHTML = buildMetas();

function showPanel(id) {
  document.querySelectorAll('.panel').forEach(p => p.classList.remove('act'));
  document.querySelectorAll('.tab').forEach(t => t.classList.remove('act'));
  document.getElementById(id).classList.add('act');
  event.target.classList.add('act');
}
</script>
</body>
</html>
